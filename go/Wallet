Wallet

import (
	"fmt"
	"time"
)

// Transaction struct to track wallet activities
type Transaction struct {
	Type      string    // "Deposit" or "Withdrawal"
	Amount    float64
	Timestamp time.Time
	Balance   float64
}

// Wallet struct
type Wallet struct {
	Balance      float64
	Transactions []Transaction
	Owner        string
}

// Initialize new wallet
func NewWallet(owner string) *Wallet {
	return &Wallet{
		Balance:      0.0,
		Transactions: make([]Transaction, 0),
		Owner:        owner,
	}
}

// AddMoney deposits money into the wallet
func (w *Wallet) AddMoney(amount float64) {
	if amount <= 0 {
		fmt.Println("Amount must be positive!")
		return
	}
	
	w.Balance += amount
	transaction := Transaction{
		Type:      "Deposit",
		Amount:    amount,
		Timestamp: time.Now(),
		Balance:   w.Balance,
	}
	w.Transactions = append(w.Transactions, transaction)
	
	fmt.Printf("Deposited $%.2f successfully!\n", amount)
}

// SpendMoney withdraws money from the wallet
func (w *Wallet) SpendMoney(amount float64) {
	if amount <= 0 {
		fmt.Println("Amount must be positive!")
		return
	}
	
	if amount > w.Balance {
		fmt.Println("Insufficient funds!")
		return
	}
	
	w.Balance -= amount
	transaction := Transaction{
		Type:      "Withdrawal",
		Amount:    amount,
		Timestamp: time.Now(),
		Balance:   w.Balance,
	}
	w.Transactions = append(w.Transactions, transaction)
	
	fmt.Printf("Withdrew $%.2f successfully!\n", amount)
}

// GetBalance returns current balance
func (w *Wallet) GetBalance() float64 {
	return w.Balance
}

// GetTransactionHistory displays all transactions
func (w *Wallet) GetTransactionHistory() {
	fmt.Println("\n=== Transaction History ===")
	if len(w.Transactions) == 0 {
		fmt.Println("No transactions yet.")
		return
	}
	
	// Using loops to iterate through transactions
	for i, t := range w.Transactions {
		fmt.Printf("%d. [%s] %s: $%.2f | Balance: $%.2f | Time: %s\n",
			i+1,
			t.Timestamp.Format("2006-01-02 15:04:05"),
			t.Type,
			t.Amount,
			t.Balance,
			t.Timestamp.Format("3:04 PM"))
	}
}

// RunWalletSystem provides console interaction
func RunWalletSystem() {
	fmt.Print("Enter wallet owner name: ")
	var owner string
	fmt.Scan(&owner)
	
	wallet := NewWallet(owner)
	
	for {
		fmt.Printf("\n=== %s's Digital Wallet ===\n", wallet.Owner)
		fmt.Printf("Current Balance: $%.2f\n", wallet.GetBalance())
		fmt.Println("1. Add Money")
		fmt.Println("2. Spend Money")
		fmt.Println("3. View Transaction History")
		fmt.Println("4. Check Balance")
		fmt.Println("5. Exit to Main Menu")
		fmt.Print("Enter choice: ")
		
		var choice string
		fmt.Scan(&choice)
		
		switch choice {
		case "1":
			var amount float64
			fmt.Print("Enter amount to deposit: $")
			fmt.Scan(&amount)
			wallet.AddMoney(amount)
			
		case "2":
			var amount float64
			fmt.Print("Enter amount to withdraw: $")
			fmt.Scan(&amount)
			wallet.SpendMoney(amount)
			
		case "3":
			wallet.GetTransactionHistory()
			
		case "4":
			fmt.Printf("Current Balance: $%.2f\n", wallet.GetBalance())
			
		case "5":
			fmt.Println("Returning to main menu...")
			return
			
		default:
			fmt.Println("Invalid choice!")
		}
	}
}